<div class="app-container">
  <!-- Background Animation -->
  <div class="background-animation">
    <div class="floating-element element-1"></div>
    <div class="floating-element element-2"></div>
    <div class="floating-element element-3"></div>
  </div>

  <!-- Header -->
  <header class="app-header">
    <div class="header-content">
      <div class="logo-section">
        <div class="app-logo">🎵</div>
        <div class="app-title">
          <h1>Generador de Presentaciones</h1>
          <p>Sistema completo para presentaciones de iglesia</p>
        </div>
      </div>
      <div class="app-stats">
        <div class="stat-card">
          <span class="stat-number">{{ presentationItems.length }}</span>
          <span class="stat-label">Elementos</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">{{ getTotalSlides() }}</span>
          <span class="stat-label">Diapositivas</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">{{ getEstimatedDuration() }}</span>
          <span class="stat-label">Minutos</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="app-main">
    <!-- Step 1: Song Search and Selection -->
    <section class="workflow-section">
      <div class="section-header">
        <div class="step-indicator">
          <span class="step-number">1</span>
        </div>
        <div class="section-title">
          <h2>Selección de Letras</h2>
          <p>Busca y selecciona las canciones desde Public/letras/</p>
        </div>
      </div>
      <app-search-bar
        [songs]="availableSongs"
        [isLoading]="isLoadingSongs"
        (songSelected)="onSongSelected($event)"
        (searchInitiated)="onSearchInitiated()">
      </app-search-bar>
    </section>

    <!-- Step 2: Media Upload -->
    <section class="workflow-section">
      <div class="section-header">
        <div class="step-indicator">
          <span class="step-number">2</span>
        </div>
        <div class="section-title">
          <h2>Carga de Multimedia</h2>
          <p>Sube videos e imágenes desde tu computadora</p>
        </div>
      </div>
      <app-media-uploader
        (mediaUploaded)="onMediaUploaded($event)">
      </app-media-uploader>
    </section>

    <!-- Step 3: Presentation Organization -->
    <section class="workflow-section">
      <div class="section-header">
        <div class="step-indicator">
          <span class="step-number">3</span>
        </div>
        <div class="section-title">
          <h2>Organización de Presentación</h2>
          <p>Ordena todos los elementos de tu presentación</p>
        </div>
      </div>
      <app-presentation-organizer
        [items]="presentationItems"
        (itemsReordered)="onItemsReordered($event)"
        (itemRemoved)="onItemRemoved($event)"
        (itemPositionChanged)="onItemPositionChanged($event)">
      </app-presentation-organizer>
    </section>

    <!-- Step 4: Export -->
    @if (presentationItems.length > 0) {
      <section class="workflow-section">
        <div class="section-header">
          <div class="step-indicator">
            <span class="step-number">4</span>
          </div>
          <div class="section-title">
            <h2>Exportar Presentación</h2>
            <p>Genera tu presentación PowerPoint personalizada</p>
          </div>
        </div>
        <div class="export-section">
          <button class="export-trigger-btn" (click)="openExportDialog()">
            <span class="export-icon">📊</span>
            <span>Exportar Presentación</span>
            <span class="export-count">({{ presentationItems.length }} elementos)</span>
          </button>
        </div>
      </section>
    }
  </main>

  <!-- Export Dialog -->
  @if (showExportDialog) {
    <app-export-dialog
      [items]="presentationItems"
      (exportConfirmed)="onExportConfirmed($event)"
      (exportCancelled)="closeExportDialog()">
    </app-export-dialog>
  }

  <!-- Loading Overlay -->
  @if (isProcessing) {
    <div class="loading-overlay">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <h3>{{ processingMessage }}</h3>
        <p>{{ processingDetail }}</p>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="processingProgress"></div>
        </div>
      </div>
    </div>
  }
</div>